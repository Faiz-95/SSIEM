<!doctype html>

<html>
    <head>
        <title>Dashboard</title>
        <meta charset="UTF-8" />
        <link rel="stylesheet" type="text/css" href="../static/style.css">
    </head>

    <div class="SIEM">
        <h2>Security Information and Event Management System</h2>
    </div>
    <div class="navbar">
        <div class="navbar-logo">
            <img src="images/bad_security.png" alt="Bad Security Inc Logo">
            <img src="images/swinburne_logo.png" alt="Swinburne Logo">
        </div>
        <header>
        <nav>
            <ul>
                <li><a href="home">Home</a></li>
                <li><a class="active" href="dashboard">Dashboard</a></li>
                <li><a href="management">Management</a></li>
                <li><a href="login">Login</a></li>
            </ul>
        </nav>
        </header>
    </div>   
    
    <body>
        <div id="table-container">
            <h2>Agent Information</h2>
            {{ agent_table|safe }}
        </div>
        <div>
            <h2>Number of Alerts Per Agent</h2>
            {{ alerts_per_agent|safe }}
        </div>
        <div>
            <h2>Distribution of Alert Severity Levels Over Time</h2>
            {{ distribution_alert_severity|safe }}
        </div>
        <div id="pie-chart-container">
            <h2>Alerts by Severity</h2>
            {{ alert_severity|safe }}
        </div>
        <div id="bar-chart-container">
            <h2>Authentication Failures Over Time</h2>
            {{ auth_failure|safe }}
        </div>
        <div>
            <h2>Hosts Against Attacks Bar Chart</h2>
            {{ bar_chart_showing_hosts|safe }}
        </div> 
        <div>
            <h2>Event Logs</h2>
            <div id="event-logs-table">
                {{ event_logs_table|safe }}
            </div>
        </div>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script>
            function fetchEventLogsTable() {
                $.get('/event_logs_table', function(data) {
                    $('#event-logs-table').html(data);
                });
            }
        
            fetchEventLogsTable();
            setInterval(fetchEventLogsTable, 5000);
        </script>
        <script src="{{ url_for('static', filename='dashboard.js') }}"></script>
    </body>
    
</html>


